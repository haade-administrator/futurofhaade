{%- assign countapi = site.countapi %}
{%- if jekyll.environment == 'production' and countapi.namespace %}
<script async src="https://api.countapi.xyz/hit/{{ countapi.namespace }}/{{ page.url | replace: '/', '-' | slice: 1, 64 }}?callback=liveViews"></script>
<script>
    var visits = [];
  
    function liveViews(index) {
      return function(response) {
        visits[index] = { id: index, visits: response.value };
      }
    }
</script>
{%- elsif jekyll.environment == 'development' and page.layout == 'post' or page.layout == 'product' %}
<script async src="https://api.countapi.xyz/create?namespace={{ countapi.namespace }}&key={{ page.url | replace: '/', '-' | slice: 1, 64 }}&enable_reset=1"></script>
{%- else %}
<script async src="https://api.countapi.xyz/create?namespace={{ countapi.namespace }}&key={{ page.url | replace: '/', '-' | slice: 1, 64 }}&enable_reset=1"></script>

{%- endif %}

<!-- ajout récupération nombre de visiteurs -->

<!-- {% for post in site.posts %}
  {%- assign url_slug = post.url | remove: 'index.html' | remove: '.html' %}
  <script async src="https://api.countapi.xyz/get/{{ countapi.namespace }}/{{ url_slug }}?callback=updateVisits({{ forloop.index0 }})"></script>
{% endfor %}

<script>
  var visits = [];

  function updateVisits(index) {
    return function(response) {
      visits[index] = { id: index, visits: response.value };
    }
  }
</script> -->